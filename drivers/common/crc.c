//////////////////////////////////////////////////////////////////////////////////////////////////
//!
//!
//////////////////////////////////////////////////////////////////////////////////////////////////

#include "types.h"

//////////////////////////////////////////////////////////////////////////////////////////////////
//!
//!     http://web.mit.edu/6.115/www/amulet/xmodem.htm
//!
//////////////////////////////////////////////////////////////////////////////////////////////////
UINT16 Crc16Update( UINT16 wCrcVal, UINT8 * pbBuffer, INT32 dwBufferLen )
{
	UINT8 i;

    while (--dwBufferLen >= 0)
    {
        wCrcVal = wCrcVal ^ (int) *pbBuffer++ << 8;

        i = 8;
        do
        {
            if (wCrcVal & 0x8000)
			{
                wCrcVal = wCrcVal << 1 ^ 0x1021;
			}
            else
			{
                wCrcVal = wCrcVal << 1;
			}
        } while(--i);
    }

    return (wCrcVal);
}
